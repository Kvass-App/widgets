import{_ as $,o as u,c as f,a as p,m as q,n as U,b as P,r as k,t as h,d as y,e as _,w as T,f as O,u as A,g as F,h as I,i as J,j as z,k as b,l as H,F as R,p as D,q as W}from"./_plugin-vue_export-helper.js";const G=`.kvass-contact-checkbox{display:flex;align-items:baseline;gap:.5rem}.kvass-contact-checkbox__element{margin:0}.kvass-contact-checkbox--required span:after{content:"*";color:var(--kvass-contact-error, var(--kvass-contact-default-error));margin-left:.3rem}
`,K=["value","checked"],Q=["innerHTML"],X={inheritAttrs:!1},Y=Object.assign(X,{__name:"Checkbox.ce",props:{modelValue:[Boolean,Array],state:String,label:String},emits:["update:modelValue"],setup(t,{emit:e}){const a=t;function r(s){return typeof a.modelValue=="boolean"?e("update:modelValue",s.target.checked):e("update:modelValue",s.target.checked?[...a.modelValue,a.state]:a.modelValue.filter(v=>v!==a.state))}return(s,v)=>(u(),f("label",{class:U(["kvass-contact-checkbox",[{"kvass-contact-checkbox--required":"required"in s.$attrs},s.$attrs.class]])},[p("input",q({class:"kvass-contact-checkbox__element",type:"checkbox"},s.$attrs,{value:t.modelValue,checked:s.$attrs.checked,onChange:r}),null,16,K),p("span",{class:"kvass-contact-checkbox__label",innerHTML:t.label},null,8,Q)],2))}}),V=$(Y,[["styles",[G]]]),Z=`.kvass-contact-field{display:flex;flex-direction:column;gap:.3rem}.kvass-contact-field__element{padding:calc(var(--kvass-contact-spacing, var(--kvass-contact-default-spacing)) / 2);border-radius:var(--kvass-contact-border-radius, var(--kvass-contact-default-border-radius));border:var(--kvass-contact-border-width, var(--kvass-contact-default-border-width)) solid var(--kvass-contact-border-color, var(--kvass-contact-default-border-color));resize:vertical;font:inherit;background-color:var(--kvass-contact-input-background, var(--kvass-contact-default-input-background))}.kvass-contact-field__element:focus-visible{outline:2px solid var(--kvass-contact-color, var(--kvass-contact-default-color));outline-offset:2px}.kvass-contact-field--required .kvass-contact-field__label:after{content:"*";color:var(--kvass-contact-error, var(--kvass-contact-default-error));margin-left:.3rem}.kvass-contact-field--required.kvass-contact-field--focused .kvass-contact-field__element:invalid{border-color:var(--kvass-contact-error, var(--kvass-contact-default-error))}.kvass-contact-field--full-width{grid-column-end:span var(--kvass-contact-grid-columns, var(--kvass-contact-default-grid-columns))}
`,ee=["for"],te={key:0,class:"kvass-contact-field__label"},ae={inheritAttrs:!1},se=Object.assign(ae,{__name:"Field.ce",props:{modelValue:[String,Array],label:String,type:String},emits:["update:modelValue"],setup(t,{emit:e}){const a=t,r=P(()=>{switch(a.type){case"textarea":return"textarea";case"select":return"select";default:return"input"}}),s=k(!1),v=k(!1);function x(i){e("update:modelValue",i.target.value),s.value=!0}function n(){s.value&&(v.value=!0)}return(i,w)=>(u(),f("label",{class:U(["kvass-contact-field",[{"kvass-contact-field--required":"required"in i.$attrs,"kvass-contact-field--focused":v.value},i.$attrs.class]]),for:i.$attrs.id},[t.label?(u(),f("span",te,h(t.label),1)):y("",!0),(u(),_(O(A(r)),q({class:"kvass-contact-field__element"},i.$attrs,{value:t.modelValue,onInput:x,onBlur:n}),{default:T(()=>[F(i.$slots,"default")]),_:3},16,["value"]))],10,ee))}}),g=$(se,[["styles",[Z]]]),ce=`.kvass-contact-fieldset{position:relative;display:flex;flex-direction:column;gap:calc(var(--kvass-contact-spacing, var(--kvass-contact-default-spacing)) / 4);margin:calc(var(--kvass-contact-spacing, var(--kvass-contact-default-spacing)) / 1.5) 0 0 0;padding:calc(var(--kvass-contact-spacing, var(--kvass-contact-default-spacing)) / 2);border-radius:var(--kvass-contact-border-radius, var(--kvass-contact-default-border-radius));border:var(--kvass-contact-border-width, var(--kvass-contact-default-border-width)) solid var(--kvass-contact-border-color, var(--kvass-contact-default-border-color));font:inherit}.kvass-contact-fieldset:focus-visible{outline:2px solid var(--kvass-contact-color, var(--kvass-contact-default-color));outline-offset:2px}.kvass-contact-fieldset__label{margin:0;padding:0;position:absolute;top:-1.4rem;left:0}
`,oe={class:"kvass-contact-fieldset"},ne={key:0,class:"kvass-contact-fieldset__label"},le={__name:"Fieldset.ce",props:{label:String},setup(t){return(e,a)=>(u(),f("fieldset",oe,[t.label?(u(),f("legend",ne,h(t.label),1)):y("",!0),F(e.$slots,"default")]))}},M=$(le,[["styles",[ce]]]);function B(t,e,a,r){return a&&a instanceof Array&&a.length?Promise.all(a.map(s=>B(t,{...e,project:s,references:[{onModel:"Project",ref:s},...e.references]}))):a!=null&&a.length?fetch(`${t}/api/graphql`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:`
				mutation ($data: LeadCreate!) {
					LeadCreate(data: $data) {
						id
					}
				}
			`,variables:{data:e}})}).then(s=>s.json()):r!=null&&r.length?re(t,{...e.contact,assignees:r},e.comment):Promise.reject(new Error("No default assignees defined"))}function re(t,e,a){return fetch(`${t}/api/graphql`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:`
				mutation ($data: ContactInput!, $comment: String) {
					ContactCreate(data: $data, comment: $comment) {
						id
					}
				}
			`,variables:{data:e,comment:a}})}).then(r=>r.json())}function ie(t){return fetch(`${t}/api/graphql`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:`
				query {
					Projects {
						id
						name
						isPublished
					}
				}
			`})}).then(e=>e.json()).then(e=>e.data.Projects.filter(a=>a.isPublished))}const de=t=>t.charAt(0).toUpperCase()+t.substring(1),ue=`.kvass-contact{--kvass-contact-default-background: #ffffff;--kvass-contact-default-spacing: 2rem;--kvass-contact-default-border-radius: 4px;--kvass-contact-default-border-color: #eaeaea;--kvass-contact-default-border-width: 1px;--kvass-contact-default-color: #222222;--kvass-contact-default-color-inverted: #ffffff;--kvass-contact-default-max-width: 720px;--kvass-contact-default-primary: #1d56d8;--kvass-contact-default-error: #d81d1d;--kvass-contact-default-grid-columns: 1;--kvass-contact-default-disabled: #eaeaea;--kvass-contact-default-input-background: #ffffff;background-color:var(--kvass-contact-background, var(--kvass-contact-default-background));padding:var(--kvass-contact-spacing, var(--kvass-contact-default-spacing));border-radius:var(--kvass-contact-border-radius, var(--kvass-contact-default-border-radius));color:var(--kvass-contact-color, var(--kvass-contact-default-color));max-width:var(--kvass-contact-max-width, var(--kvass-contact-default-max-width));font:inherit;accent-color:var(--kvass-contact-primary, var(--kvass-contact-default-primary));display:flex;flex-direction:column;gap:var(--kvass-contact-spacing, var(--kvass-contact-default-spacing))}@media (max-width: 600px){.kvass-contact{--kvass-contact-grid-columns: 1;padding:calc(var(--kvass-contact-spacing, var(--kvass-contact-default-spacing)) / 2)}}.kvass-contact *:focus-visible{outline:2px solid var(--kvass-contact-color, var(--kvass-contact-default-color));outline-offset:2px}.kvass-contact__header{display:flex;flex-direction:column;gap:.5rem}.kvass-contact__fields{display:grid;grid-template-columns:repeat(var(--kvass-contact-grid-columns, var(--kvass-contact-default-grid-columns)),1fr);gap:calc(var(--kvass-contact-spacing, var(--kvass-contact-default-spacing)) / 2)}.kvass-contact__title{font-size:2rem;margin:0}.kvass-contact__subtitle{opacity:.7;margin:0}.kvass-contact__submit{padding:calc(var(--kvass-contact-spacing, var(--kvass-contact-default-spacing)) / 2);border-radius:var(--kvass-contact-border-radius, var(--kvass-contact-default-border-radius));background-color:var(--kvass-contact-primary, var(--kvass-contact-default-primary));color:var(--kvass-contact-color-inverted, var(--kvass-contact-default-color-inverted));border:none;font:inherit;width:100%;cursor:pointer}.kvass-contact__submit:active{filter:brightness(.95)}.kvass-contact__submit:disabled{background-color:var(--kvass-contact-disabled, var(--kvass-contact-default-disabled));color:var(--kvass-contact-color, var(--kvass-contact-default-color));cursor:not-allowed}.kvass-contact a{color:inherit}
`,ve=["onSubmit"],fe={class:"kvass-contact__header"},ke={class:"kvass-contact__title"},me={key:0,class:"kvass-contact__subtitle"},pe={class:"kvass-contact__fields"},be=["disabled"],ge={__name:"Form.ce",props:{lang:{type:String,default:()=>document.documentElement.getAttribute("lang")||"nb"},privacyUrl:String,upsell:{type:Boolean,default:!1},accountUrl:{type:String,required:!0},projects:{type:String,default:""},references:{type:String,default:""},tags:{type:String,default:""},defaultAssignees:String},setup(t){const e=t,a={nb:{title:"Meld interesse",submit:"Meld interesse",name:"Navn",email:"E-post",phone:"Telefonnummer",message:"Melding",projects:"Hvilke prosjekter er du interessert i?",upsell:"Jeg ønsker informasjon om lignende prosjekter",privacy:"Jeg ønsker å bli kontaktet i samtykke med [personvernerklæringen]",success:"Takk for interessen!"},en:{title:"Contact agent",submit:"Submit",name:"Name",email:"Email",phone:"Phone",message:"Message",projects:"Which projects are you interested in?",upsell:"I want to know about other similar projects",privacy:"I agree to the [privacy policy]",success:"Thank you for your interest"}},r=I(),s=k(!1),v=P(()=>e.privacyUrl?e.privacyUrl:`${e.accountUrl}/api/legal/privacy/tenant`),x={contact:{name:null,email:null,phone:null,upsell:!1,tags:e.tags.split(",")},comment:null},n=J(structuredClone(x)),i=k(!1),w=k([]),m=k([]),j=k([]);function d(l){let c=r["label"+de(l)]||a[e.lang][l];return l==="privacy"?c.replace(/\[(.+)\]/,`<a href="${v.value}" target="_blank">$1</a>`):c}function N(){n.comment=null,n.contact.upsell=!1,s.value=!1,m.value=[]}function E(){var l;B(e.accountUrl,{...n,references:j.value},m.value,(l=e.defaultAssignees)==null?void 0:l.split(",")).then(()=>{i.value=!0,N(),setTimeout(()=>i.value=!1,2e3)})}function L(){const l=e.references.split(",").filter(Boolean).map(c=>{const[o,S]=c.split(":");return{onModel:o,ref:S}});j.value=l}return z(()=>{e.projects?e.projects.split(",").forEach(l=>m.value.push(l)):ie(e.accountUrl).then(l=>w.value=l),L()}),(l,c)=>(u(),f("form",{class:"kvass-contact",onSubmit:H(E,["prevent"])},[p("div",fe,[p("h2",ke,h(d("title")),1),d("subtitle")?(u(),f("p",me,h(d("subtitle")),1)):y("",!0)]),p("div",pe,[b(g,{label:d("name"),type:"text",required:"",modelValue:n.contact.name,"onUpdate:modelValue":c[0]||(c[0]=o=>n.contact.name=o)},null,8,["label","modelValue"]),b(g,{label:d("email"),type:"email",pattern:"\\b[\\w\\.-]+@[\\w\\.-]+\\.\\w{2,4}",required:"",modelValue:n.contact.email,"onUpdate:modelValue":c[1]||(c[1]=o=>n.contact.email=o)},null,8,["label","modelValue"]),b(g,{label:d("phone"),type:"tel",modelValue:n.contact.phone,"onUpdate:modelValue":c[2]||(c[2]=o=>n.contact.phone=o)},null,8,["label","modelValue"]),t.projects?y("",!0):(u(),_(M,{key:0,label:d("projects")},{default:T(()=>[(u(!0),f(R,null,D(w.value,o=>(u(),_(V,{key:o.id,state:o.id,label:o.name,checked:m.value.includes(o.id),modelValue:m.value,"onUpdate:modelValue":c[3]||(c[3]=S=>m.value=S)},null,8,["state","label","checked","modelValue"]))),128))]),_:1},8,["label"])),b(g,{label:d("message"),type:"textarea",rows:"5",class:"kvass-contact-field--full-width",modelValue:n.comment,"onUpdate:modelValue":c[4]||(c[4]=o=>n.comment=o)},null,8,["label","modelValue"]),t.upsell?(u(),_(V,{key:1,label:d("upsell"),class:"kvass-contact-field--full-width",checked:n.contact.upsell,modelValue:n.contact.upsell,"onUpdate:modelValue":c[5]||(c[5]=o=>n.contact.upsell=o)},null,8,["label","checked","modelValue"])):y("",!0),b(V,{label:d("privacy"),class:"kvass-contact-field--full-width",required:"",checked:s.value,modelValue:s.value,"onUpdate:modelValue":c[6]||(c[6]=o=>s.value=o)},null,8,["label","checked","modelValue"])]),p("button",{class:"kvass-contact__submit",type:"submit",disabled:i.value},h(i.value?d("success"):d("submit")),9,be)],40,ve))}},C=$(ge,[["styles",[ue]]]);C.styles=[...C.styles,...g.styles,...M.styles,...V.styles];customElements.define("kvass-contact",W(C));
